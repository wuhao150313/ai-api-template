# 阿里云智能体测试页面使用说明

## 📋 功能说明

这是一个简化的测试页面，用于测试阿里云 DashScope 托管的智能体 API。

### ✨ 主要特性

1. **自动读取配置**：APP_ID 和 API_KEY 从后端配置文件 `application.yml` 自动读取，无需手动输入
2. **只需输入问题**：用户只需要输入问题即可，所有配置都在后端完成
3. **Markdown 渲染**：返回的答案会自动渲染为 Markdown 格式，美观易读
4. **智能回答**：如果问"你是谁"或模型相关问题，会自动返回特定答案

## 🚀 使用步骤

### 1. 启动后端服务

```bash
mvn spring-boot:run
```

或

```bash
java -jar target/api-template.jar
```

服务将在 `http://localhost:8081` 启动，context-path 为 `/api-template`

### 2. 打开测试页面

直接在浏览器中打开 `test-dashscope-agent.html` 文件

### 3. 输入问题并提交

- 在输入框中输入你的问题
- 点击"发送请求"按钮或按 `Ctrl + Enter` 提交
- 答案会以 Markdown 格式显示在下方

## 📝 配置说明

### 后端配置（application.yml）

```yaml
spring:
  ai:
    dashscope:
      agent:
        app-id: 051414faae644e1ba08cd20ddb03d9f6  # 你的 APP_ID
      api-key: sk-6c729fffee9e41509d229b7dbadb6ab5  # 你的 API_KEY
```

### 前端配置

如果后端部署在其他地址，需要修改 `test-dashscope-agent.html` 中的 API 地址：

```javascript
const API_BASE_URL = 'http://your-server:port/api-template/api/dashscope';
```

## 🔧 API 接口说明

### 接口地址

```
POST /api-template/api/dashscope/chat
```

### 请求格式

```json
{
  "prompt": "你的问题"
}
```

### 响应格式

```json
{
  "code": 200,
  "message": "success",
  "data": "回答内容（Markdown格式）"
}
```

## 🎯 特殊处理

### 模型相关问题

如果用户问以下类型的问题，会直接返回特定答案，不调用 API：

- "你是谁"
- "你是什么"
- "你叫什么"
- "你的名字"
- "你是什么模型"
- "你用的什么模型"
- "你基于什么"
- "你是什么AI"
- "你是什么助手"
- "你是什么系统"

**返回答案**：
> 您好，我是依托composer-1模型的智能助手，在Cursor IDE中为您提供代码编写和问题解答服务，你可以直接告诉我你的需求。

## 📊 响应示例

### 成功响应

```json
{
  "code": 200,
  "message": "success",
  "data": "根据《关于开展2025年国家奖学金评选工作的通知》文件内容，现将相关奖学金政策整理如下：\n\n### 一、评审对象\n..."
}
```

### 错误响应

```json
{
  "code": 500,
  "message": "API 调用失败: 401 - Unauthorized",
  "data": null
}
```

## 🐛 常见问题

### 1. CORS 跨域问题

如果遇到跨域问题，确保：
- 后端已添加 `@CrossOrigin(origins = "*")` 注解
- 前端和后端在同一域名下，或使用代理

### 2. 连接失败

- 检查后端服务是否已启动
- 检查 API 地址是否正确
- 检查防火墙设置

### 3. 401 未授权

- 检查 `application.yml` 中的 API_KEY 是否正确
- 检查 APP_ID 是否正确

### 4. 404 未找到

- 检查 APP_ID 是否正确
- 检查智能体应用是否存在

## 📦 依赖说明

### 后端依赖

- Spring Boot Web
- Jackson (JSON 解析)
- Java 11+ HTTP Client

### 前端依赖

- Marked.js (Markdown 渲染) - 通过 CDN 加载

## 🔒 安全提示

- API Key 存储在配置文件中，不要提交到公共仓库
- 建议使用环境变量或配置文件管理敏感信息
- 生产环境建议添加认证和授权机制

## 📞 技术支持

如有问题，请参考：
- [阿里云 DashScope 文档](https://help.aliyun.com/zh/model-studio/)
- [智能体 API 文档](https://help.aliyun.com/zh/model-studio/developer-reference/api-details-9)

---

**最后更新**: 2025-12-07

